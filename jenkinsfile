node(){
    stage('init'){
        dir("build_project"){
            checkout([$class: 'GitSCM',
                branches: [[name: '*/dev']],
                doGenerateSubmoduleConfigurations: false,
                extensions: [[$class: 'CleanCheckout']],
                submoduleCfg: [],
                userRemoteConfigs: [[credentialsId: 'my-git-credentials', url: 'https://github.com/sofackj/jenkins-docker-ansible.git']]
            ])
        }
    }
    stage("Clean outside new directories"){
        clean_useless()
    }
    // stage ('Build and Deployment') {
    //     def ANSIBLE_IMG = docker.build (
    //         "my-ansible",
    //         "./docker_for_jenkins/dockerfiles/ansible_controller/"
    //         )
    //     ANSIBLE_IMG.inside ('-u root') {
    //         sh "ansible --version"
    //         sh "ls"
    //     }
    // }
    stage("first"){
        echo "Hello World !!!"
    }
    stage("second"){
        echo "Bye World !!!"
    }
}

def clean_useless(){
    sh "find . ! -name *_project ! -name '.*' | xargs rm -rf"
    sh "pwd"
    sh "ls"
    sh "tree"
}